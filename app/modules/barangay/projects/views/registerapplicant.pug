extends ../../home/views/navbar.pug

block content
    <div class="right_col" role="main">
        <div class="">
            <div class="col-md-12 col-sm-12 col-xs-12">
                <div class="x_panel">
                    <div class="x_title">
                        each project in tbl_project
                            <center>
                                <h1>APPLICATION FORM</h1>
                                <h4>
                                    value=project.varchar_projectName
                                </h4>
                                <small>
                                    value="(" + project.text_projectObjective + ")"
                                </small>
                            </center>
                        
                        <div class="clearfix"></div>
                    </div>
                    <form id="regForm" action="" method="POST" class="form-horizontal form-label-left">
                        <div class="x_content">
                            <!-- Smart Wizard -->

                            <div id="wizard" class="form_wizard wizard_horizontal">
                                <ul class="wizard_steps">
                                    <li>
                                        <a href="#basicinfotab">
                                            <span class="step_no">1</span>
                                            <span class="step_descr"> Step 1<br />
                                                <small>Basic Information</small>
                                            </span>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#requirement">
                                            <span class="step_no">2</span>
                                            <span class="step_descr"> Step 2<br />
                                                <small>Check Requirements</small>
                                            </span>
                                        </a>
                                    </li>
                                </ul>

                                <div class="tab" id="basicinfotab">
                                    <hr/>
                                    <h3>BASIC PERSONAL INFORMATION</h3>
                                    <div class="form-row">
                                        <div class="form-group col-md-4 col-sm-12">
                                            <label for="ap-fname" class="form-control-label"><strong>First</strong> Name</label>
                                                <input type="text" id="ap-fname" name="apply_fname" placeholder="Applicant's First name ..." class="names col-sm-11 form-control ">
                                        </div>
                                        <div class="form-group col-md-4 col-sm-12">
                                            <label for="ap-lname" class="form-control-label"><strong>Last</strong> Name</label>
                                                <input type="text" id="ap-lname" name="apply_mname" placeholder="Applicant's Last name ..." class="names col-sm-11 form-control ">
                                        </div>
                                        <div class="form-group col-md-4 col-sm-12">
                                            <label for="ap-mname" class="form-control-label"><strong>Middle</strong> Name</label>
                                                <input type="text" id="ap-mname" name="apply_lname" placeholder="Applicant's Middle name ..." class="middle col-sm-11 form-control ">
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group col-md-4 col-sm-12">
                                            <label for="ap-birthdate" class="form-control-label"><strong>Birthdate</strong></label>
                                                <input type="date" id="ap-birthdate" name="apply_birthdate" placeholder="Birthdate" class="col-sm-11 form-control ">
                                        </div>
                                        <div class="form-group col-md-3 col-sm-12">
                                            <label for="ap-number" class="form-control-label"><strong>Contact Number</strong></label>
                                                <input type="text" id="ap-number" name="apply_contact" data-inputmask="'mask' : '(+63) 999-999-9999'" class="col-sm-11 form-control ">
                                        </div>
                                        <div class="form-group col-md-5 col-sm-12">
                                            <label for="ap-email" class="form-control-label"><strong>Email Address</strong></label>
                                                <input type="email" id="ap-email" name="apply_emailaddress" placeholder="(ex: abc@gmail.com)" class="col-sm-11 form-control ">
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group col-md-4 col-sm-12">
                                            <label for="ap-gender" class="control-label"><strong>Gender</strong></label>
                                            <div class="form-check form-check-inline" id="ap-gender">
                                                <label class="form-check-label">
                                                    <input class="form-check-input" type="radio" value="Male" name="apply_gender" id="inlineRadio1"> Male
                                                </label>
                                            </div>
                                            <div class="form-check form-check-inline">
                                                <label class="form-check-label">
                                                    <input class="form-check-input" type="radio" value="Female" name="apply_gender" id="inlineRadio2"> Female
                                                </label>
                                            </div>
                                        </div>
                                        
                                        <div class="form-group col-md-4 col-sm-12">
                                            <label for="ap-yrres" class="form-control-label"><strong>Year of Residency</strong></label>
                                                <input type="text" id="ap-yrres" name="apply_yrres" placeholder="(ex. 20xx, 2010)" class="col-sm-11 form-control ">
                                        </div>
                                        <div class="form-group col-md-4 col-sm-12">
                                            <label for="ap-civilstat" class="form-control-label"><strong>Civil Status</strong></label>
                                            <select class="form-control" id="ap-civilstat" name="apply_civilstat">
                                                <option value="Single">Single</option>
                                                <option value="Married">Married</option>
                                                <option value="Widowed">Widowed</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                //- END OF FIRST TAB


                                //- APPLICANT'S REQUIREMENT/S
                                <div class="tab" id="requirement">
                                    <hr/>
                                    <h3>APPLICANT'S REQUIREMENT LIST</h3>
                                    <small>Below are the list of the requirements that the applicant needed to comply</small>


                                    <div class="table-responsive m-b-40">
                                        <table class="table table-bordered">
                                            <thead>
                                                <tr>
                                                    <th>Requirement</th>
                                                    <th>Status</th>
                                                    <th>File Location</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                 each requirement in requirements 
                                                    <tr>
                                                        <td>
                                                            value=requirement.varchar_requirementName
                                                        </td>
                                                        <td>
                                                            <div class="form-group">
                                                                <div id="gender" class="btn-group" data-toggle="buttons">
                                                                    
                                                                </div>
                                                            </div>
                                                        </td>
                                                        <td>
                                                            input(type="text" id="ap-requirementid" name="requirementID[]" value=`${requirement.int_requirementID}` hidden)
                                                            <input type="text" id="ap-storage" name="storageid[]" placeholder="Storage Number" class="col-sm-11 form-control ">
                                                        </td>
                                                    </tr>                   
                                            </tbody>
                                        </table>
                                    </div>
                                </div> 
                                //- END OF APPLICANT'S REQUIREMENT/S 

                            </div>
                            <!-- End SmartWizard Content -->
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    //- SCRIPT FOR TABS
    script.
        var currentTab = 0; // Current tab is set to be the first tab (0)
        showTab(currentTab); // Display the current tab

        function showTab(n) {
        // This function will display the specified tab of the form ...
        var x = document.getElementsByClassName("tab");
        x[n].style.display = "block";
        // ... and fix the Previous/Next buttons:
        if (n == 0) {
            document.getElementById("prevBtn").style.display = "none";
        } else {
            document.getElementById("prevBtn").style.display = "inline";
        }
        if (n == (x.length - 1)) {
            document.getElementById("nextBtn").innerHTML = "Submit";
        } else {
            document.getElementById("nextBtn").innerHTML = "Next";
        }
        // ... and run a function that displays the correct step indicator:
        fixStepIndicator(n)
        }

        function nextPrev(n) {
        // This function will figure out which tab to display
        var x = document.getElementsByClassName("tab");
        // Exit the function if any field in the current tab is invalid:
        if (n == 1 && !validateForm()) return false;
        // Hide the current tab:
        x[currentTab].style.display = "none";
        // Increase or decrease the current tab by 1:
        currentTab = currentTab + n;
        // if you have reached the end of the form... :
        if (currentTab >= x.length) {
            //...the form gets submitted:
            document.getElementById("regForm").submit();
            return false;
        }
        // Otherwise, display the correct tab:
        showTab(currentTab);
        }

        function validateForm() {
        // This function deals with validation of the form fields
        var x, names,middle, a, b, valid = true;
        x = document.getElementsByClassName("tab");
        
        //- VALIDATE APPLICATION NAMES(FIRST, LAST)
        var noespchar = `[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]`;
        names = x[currentTab].getElementsByClassName("names");
        middle = x[currentTab].getElementsByClassName("middle");
        //- END VALIDATE APPLICATION NAMES
        
        // A loop that checks every input field in the current tab:

        //- NAMES(FIRST AND LAST)
        for (a = 0; a < names.length; a++) {
            // If a field is empty...
            if (names[a].value == "" || names[a].value == noespchar ||  names[a].value == " ") {
            console.log("INVALID NAMES(FIRST AND LAST)")
            // add an "invalid" class to the field:
            names[a].className += "invalid";
            // and set the current valid status to false:
            valid = false;
            }
        }
        //- END OF NAMES(FIRST AND LAST)
        //- NAME(MIDDLE NAME)
        for (b = 0; b < middle.length; b++) {
            // If a field is empty...
            if (middle[b].value == noespchar ||  middle[b].value == " ") {
            console.log("INVALID NAME(MIDDLE)")
            // add an "invalid" class to the field:
            middle[b].className += "invalid";
            // and set the current valid status to false:
            valid = false;
            }
        }
        //- END OF NAMES(MIDDLENAME)


        // If the valid status is true, mark the step as finished and valid:
        if (valid) {
            document.getElementsByClassName("step")[currentTab].className += " finish";
        }
        return valid; // return the valid status
        }

        function fixStepIndicator(n) {
        // This function removes the "active" class of all steps...
        var i, x = document.getElementsByClassName("step");
        for (i = 0; i < x.length; i++) {
            x[i].className = x[i].className.replace(" active", "");
        }
        //... and adds the "active" class to the current step:
        x[n].className += " active";
        }


        (function ($) {
            var next = 1;
            $(".add-more").click(function(e){
                e.preventDefault();
                var addto = "#field" + next;
                var addRemove = "#field" + (next);
                next = next + 1;
                var newIn = '<input autocomplete="off" class="input form-control" id="field' + next + '" name="field' + next + '" type="text">';
                var newInput = $(newIn);
                var removeBtn = '<button id="remove' + (next - 1) + '" class="btn btn-danger remove-me" >-</button></div><div id="field">';
                var removeButton = $(removeBtn);
                $(addto).after(newInput);
                $(addRemove).after(removeButton);
                $("#field" + next).attr('data-source',$(addto).attr('data-source'));
                $("#count").val(next);  
                
                    $('.remove-me').click(function(e){
                        e.preventDefault();
                        var fieldNum = this.id.charAt(this.id.length-1);
                        var fieldID = "#field" + fieldNum;
                        $(this).remove();
                        $(fieldID).remove();
                    });
            });            
        });
        //- SCRIPT FOR LABEL
        (function ($) {
            $.fn.floatLabels = function (options) {

                // Settings
                var self = this;
                var settings = $.extend({}, options);


                // Event Handlers
                function registerEventHandlers() {
                    self.on('input keyup change', 'input, textarea', function () {
                        actions.swapLabels(this);
                    });
                }


                // Actions
                var actions = {
                    initialize: function() {
                        self.each(function () {
                            var $this = $(this);
                            var $label = $this.children('label');
                            var $field = $this.find('input,textarea').first();

                            if ($this.children().first().is('label')) {
                                $this.children().first().remove();
                                $this.append($label);
                            }

                            var placeholderText = ($field.attr('placeholder') && $field.attr('placeholder') != $label.text()) ? $field.attr('placeholder') : $label.text();

                            $label.data('placeholder-text', placeholderText);
                            $label.data('original-text', $label.text());

                            if ($field.val() == '') {
                                $field.addClass('empty')
                            }
                        });
                    },
                    swapLabels: function (field) {
                        var $field = $(field);
                        var $label = $(field).siblings('label').first();
                        var isEmpty = Boolean($field.val());

                        if (isEmpty) {
                            $field.removeClass('empty');
                            $label.text($label.data('original-text'));
                        }
                        else {
                            $field.addClass('empty');
                            $label.text($label.data('placeholder-text'));
                        }
                    }
                }


                // Initialization
                function init() {
                    registerEventHandlers();

                    actions.initialize();
                    self.each(function () {
                        actions.swapLabels($(this).find('input,textarea').first());
                    });
                }
                init();


                return this;
            };

            $(function () {
                $('.float-label-control').floatLabels();
            });
        })(jQuery);

        //- END OF SCRIPT FOR LABEL